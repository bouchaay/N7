/* @author : Ayoub
 * @groupe : F
 * @description : mini-minishell
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/wait.h>

int main() {
    char buf[30]; /* contient la commande saisie au clavier */
    int ret; /* valeur de retour de scanf */
    pid_t pidFils; /* pid du fils */
    int codeTerm; /* status du fils */

    do {
        printf(">>> ");
        ret = scanf("%s", buf);
        if ((strcmp(buf, "exit") == 0) || (ret == EOF)) {
            break;
        }
        pidFils = fork();
        if (pidFils == 0) {
            /* fils */
            execlp(buf, buf, NULL);
            exit(EXIT_FAILURE);
        } else if (pidFils == -1) {
            /* erreur */
            printf("Erreur de création du fils");
            exit(EXIT_FAILURE);
        } else {
            /* père */
            wait(&codeTerm);
            if (WIFEXITED(codeTerm) && codeTerm == 0) {
                printf("SUCCES\n");
            } else {
                printf("ECHEC\n");
            }
        }
    } while (ret != EOF);
    // afficher le message de fin 'Salut'
    printf("Salut");
    return EXIT_SUCCESS;
}
